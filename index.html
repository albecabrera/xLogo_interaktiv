<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xLogo Lernwelt - Spielerisch Programmieren lernen</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header mit Rubox-Anzeige -->
        <header class="main-header">
            <div class="logo">
                <span class="turtle-icon">üê¢</span>
                <h1>xLogo Lernwelt</h1>
            </div>
            <div class="stats-bar">
                <div class="rubox-display">
                    <span class="rubox-icon">üíé</span>
                    <span class="rubox-count" id="ruboxCount">0</span>
                    <span class="rubox-label">Rubox</span>
                </div>
                <div class="level-display">
                    <span class="level-icon">‚≠ê</span>
                    <span class="level-text" id="playerLevel">Level 1</span>
                </div>
                <div class="streak-display">
                    <span class="streak-icon">üî•</span>
                    <span class="streak-count" id="streakCount">0</span>
                </div>
            </div>
            <nav class="main-nav">
                <button class="nav-btn active" data-view="learn">üìö Lernen</button>
                <button class="nav-btn" data-view="sandbox">üéÆ Sandbox</button>
                <button class="nav-btn" data-view="admin">‚öôÔ∏è Aufgaben erstellen</button>
                <button class="nav-btn share-btn" id="shareBtn">üì§ Teilen</button>
            </nav>
        </header>

        <!-- Hauptinhalt -->
        <main class="main-content">
            <!-- Lern-Ansicht -->
            <section class="view learn-view active" id="learnView">
                <div class="difficulty-selector">
                    <h2>W√§hle deinen Schwierigkeitsgrad</h2>
                    <div class="difficulty-cards">
                        <button class="difficulty-card beginner active" data-difficulty="beginner">
                            <span class="difficulty-emoji">üå±</span>
                            <span class="difficulty-name">Anf√§nger</span>
                            <span class="difficulty-desc">Erste Schritte mit der Schildkr√∂te</span>
                            <span class="difficulty-reward">+10 Rubox</span>
                        </button>
                        <button class="difficulty-card intermediate" data-difficulty="intermediate">
                            <span class="difficulty-emoji">üåø</span>
                            <span class="difficulty-name">Fortgeschritten</span>
                            <span class="difficulty-desc">Schleifen und Formen</span>
                            <span class="difficulty-reward">+25 Rubox</span>
                        </button>
                        <button class="difficulty-card advanced" data-difficulty="advanced">
                            <span class="difficulty-emoji">üå≥</span>
                            <span class="difficulty-name">Experte</span>
                            <span class="difficulty-desc">Komplexe Figuren und Prozeduren</span>
                            <span class="difficulty-reward">+50 Rubox</span>
                        </button>
                    </div>
                </div>

                <div class="task-area">
                    <div class="task-panel">
                        <div class="task-header">
                            <h3>Aktuelle Aufgabe</h3>
                            <span class="task-number" id="taskNumber">1/5</span>
                        </div>
                        <div class="task-content" id="taskContent">
                            <p class="task-description">W√§hle einen Schwierigkeitsgrad, um zu beginnen!</p>
                        </div>
                        <div class="hint-area" id="hintArea">
                            <button class="hint-btn" id="hintBtn">üí° Hinweis anzeigen (-5 Rubox)</button>
                            <div class="hint-content" id="hintContent"></div>
                        </div>
                        <div class="expected-preview" id="expectedPreview">
                            <h4>Erwartetes Ergebnis:</h4>
                            <canvas id="expectedCanvas" width="200" height="200"></canvas>
                        </div>
                    </div>

                    <div class="workspace">
                        <div class="canvas-area">
                            <div class="canvas-container">
                                <canvas id="turtleCanvas" width="500" height="400"></canvas>
                            </div>

                            <!-- Alle Steuerungs-Buttons -->
                            <div class="control-toolbar">
                                <div class="control-group">
                                    <button class="control-btn run-btn" id="runBtn" title="Ausf√ºhren (F5)">
                                        <span class="btn-icon">‚ñ∂Ô∏è</span>
                                        <span class="btn-text">Ausf√ºhren</span>
                                        <span class="shortcut">F5</span>
                                    </button>
                                    <button class="control-btn stop-btn" id="stopBtn" title="Stoppen (Esc)">
                                        <span class="btn-icon">‚èπÔ∏è</span>
                                        <span class="btn-text">Stopp</span>
                                    </button>
                                </div>

                                <div class="control-group step-controls">
                                    <button class="control-btn" id="stepBackBtn" title="Schritt zur√ºck (‚Üê)">
                                        <span class="btn-icon">‚èÆÔ∏è</span>
                                        <span class="btn-text">Zur√ºck</span>
                                    </button>
                                    <button class="control-btn" id="stepForwardBtn" title="Schritt vorw√§rts (‚Üí)">
                                        <span class="btn-icon">‚è≠Ô∏è</span>
                                        <span class="btn-text">Vorw√§rts</span>
                                    </button>
                                </div>

                                <div class="control-group">
                                    <button class="control-btn" id="resetBtn" title="Reset">
                                        <span class="btn-icon">üîÑ</span>
                                        <span class="btn-text">Reset</span>
                                    </button>
                                    <button class="control-btn" id="clearBtn" title="Code l√∂schen">
                                        <span class="btn-icon">üóëÔ∏è</span>
                                        <span class="btn-text">L√∂schen</span>
                                    </button>
                                </div>

                                <div class="control-group speed-control">
                                    <label for="speedSlider">üê¢</label>
                                    <input type="range" id="speedSlider" min="1" max="10" value="5" title="Geschwindigkeit">
                                    <label for="speedSlider">üêá</label>
                                    <span class="speed-value" id="speedValue">5x</span>
                                </div>
                            </div>
                        </div>

                        <div class="code-console-area">
                            <div class="code-panel">
                                <div class="code-header">
                                    <h4>Dein Code</h4>
                                    <div class="code-hints">
                                        <span class="code-hint" title="forward(schritte)">fd()</span>
                                        <span class="code-hint" title="back(schritte)">bk()</span>
                                        <span class="code-hint" title="right(grad)">rt()</span>
                                        <span class="code-hint" title="left(grad)">lt()</span>
                                        <span class="code-hint" title="repeat anzahl:">repeat:</span>
                                    </div>
                                </div>
                                <div class="code-editor-container">
                                    <div class="line-numbers" id="lineNumbers"></div>
                                    <textarea id="codeInput" spellcheck="false" placeholder="# Schreibe hier deinen xLogo-Code...
# Beispiel:
fd(100)
rt(90)
fd(100)

# Schleife mit Einr√ºckung:
repeat 4:
    fd(100)
    rt(90)"></textarea>
                                </div>
                            </div>

                            <!-- Konsole -->
                            <div class="console-panel">
                                <div class="console-header">
                                    <h4>Konsole</h4>
                                    <button class="console-clear-btn" id="clearConsoleBtn" title="Konsole leeren">üóëÔ∏è</button>
                                </div>
                                <div class="console-output" id="consoleOutput">
                                    <div class="console-welcome">Willkommen! Dr√ºcke F5 oder klicke auf "Ausf√ºhren".</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sandbox-Ansicht -->
            <section class="view sandbox-view" id="sandboxView">
                <div class="sandbox-layout">
                    <div class="sandbox-canvas-area">
                        <div class="canvas-container">
                            <canvas id="sandboxCanvas" width="600" height="500"></canvas>
                        </div>
                        <div class="control-toolbar">
                            <div class="control-group">
                                <button class="control-btn run-btn" id="sandboxRunBtn" title="Ausf√ºhren (F5)">
                                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                                    <span class="btn-text">Ausf√ºhren</span>
                                </button>
                                <button class="control-btn stop-btn" id="sandboxStopBtn" title="Stoppen">
                                    <span class="btn-icon">‚èπÔ∏è</span>
                                    <span class="btn-text">Stopp</span>
                                </button>
                            </div>
                            <div class="control-group step-controls">
                                <button class="control-btn" id="sandboxStepBackBtn" title="Schritt zur√ºck">
                                    <span class="btn-icon">‚èÆÔ∏è</span>
                                </button>
                                <button class="control-btn" id="sandboxStepForwardBtn" title="Schritt vorw√§rts">
                                    <span class="btn-icon">‚è≠Ô∏è</span>
                                </button>
                            </div>
                            <div class="control-group">
                                <button class="control-btn" id="sandboxResetBtn" title="Reset">
                                    <span class="btn-icon">üîÑ</span>
                                </button>
                                <button class="control-btn" id="sandboxClearBtn" title="L√∂schen">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                </button>
                            </div>
                            <div class="control-group">
                                <input type="color" id="penColor" value="#00aa00" title="Stiftfarbe">
                                <input type="range" id="penWidth" min="1" max="10" value="2" title="Stiftbreite">
                            </div>
                            <div class="control-group speed-control">
                                <label>üê¢</label>
                                <input type="range" id="sandboxSpeedSlider" min="1" max="10" value="5">
                                <label>üêá</label>
                            </div>
                        </div>
                    </div>

                    <div class="sandbox-code-area">
                        <div class="command-reference">
                            <h4>xLogo Befehlsreferenz:</h4>
                            <div class="command-list">
                                <div class="command-item"><code>fd(X)</code> - Forward: X Schritte vorw√§rts</div>
                                <div class="command-item"><code>bk(X)</code> - Back: X Schritte r√ºckw√§rts</div>
                                <div class="command-item"><code>rt(X)</code> - Right: X Grad nach rechts</div>
                                <div class="command-item"><code>lt(X)</code> - Left: X Grad nach links</div>
                                <div class="command-item"><code>pu()</code> - Pen Up: Stift hoch</div>
                                <div class="command-item"><code>pd()</code> - Pen Down: Stift runter</div>
                                <div class="command-item"><code>repeat X:</code> - Wiederhole (mit Einr√ºckung!)</div>
                                <div class="command-item"><code>setpc("rot")</code> - Stiftfarbe</div>
                                <div class="command-item"><code>setpw(X)</code> - Stiftbreite</div>
                                <div class="command-item"><code>cs()</code> - Clear Screen</div>
                                <div class="command-item"><code>home()</code> - Zur√ºck zur Mitte</div>
                                <div class="command-item"><code>print("text")</code> - Ausgabe in Konsole</div>
                            </div>
                        </div>

                        <div class="code-editor-container">
                            <div class="line-numbers" id="sandboxLineNumbers"></div>
                            <textarea id="sandboxCode" spellcheck="false" placeholder="# Freies Experimentieren!
# Beispiel - Quadrat:

repeat 4:
    fd(100)
    rt(90)

print('Quadrat fertig!')"></textarea>
                        </div>

                        <div class="console-panel">
                            <div class="console-header">
                                <h4>Konsole</h4>
                                <button class="console-clear-btn" id="sandboxClearConsoleBtn">üóëÔ∏è</button>
                            </div>
                            <div class="console-output" id="sandboxConsoleOutput">
                                <div class="console-welcome">Bereit zum Experimentieren!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin-Ansicht -->
            <section class="view admin-view" id="adminView">
                <div class="admin-container">
                    <h2>Aufgaben erstellen</h2>
                    <p class="admin-intro">Erstelle eigene Aufgaben f√ºr deine Sch√ºler. Die Aufgaben werden lokal gespeichert und k√∂nnen als Code exportiert werden.</p>

                    <div class="admin-form">
                        <div class="form-group">
                            <label for="taskTitle">Aufgabentitel:</label>
                            <input type="text" id="taskTitle" placeholder="z.B. Zeichne ein Dreieck">
                        </div>

                        <div class="form-group">
                            <label for="taskDescription">Aufgabenbeschreibung:</label>
                            <textarea id="taskDescription" placeholder="Beschreibe die Aufgabe ausf√ºhrlich..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="taskDifficulty">Schwierigkeitsgrad:</label>
                            <select id="taskDifficulty">
                                <option value="beginner">üå± Anf√§nger (+10 Rubox)</option>
                                <option value="intermediate">üåø Fortgeschritten (+25 Rubox)</option>
                                <option value="advanced">üå≥ Experte (+50 Rubox)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="taskSolution">Musterl√∂sung (Code):</label>
                            <textarea id="taskSolution" placeholder="fd(100)
rt(120)
fd(100)
rt(120)
fd(100)"></textarea>
                        </div>

                        <div class="form-group">
                            <label for="taskHint">Hinweis f√ºr Sch√ºler:</label>
                            <textarea id="taskHint" placeholder="Ein hilfreicher Hinweis..."></textarea>
                        </div>

                        <div class="form-group">
                            <label>Vorschau der Musterl√∂sung:</label>
                            <div class="preview-container">
                                <canvas id="adminPreviewCanvas" width="300" height="300"></canvas>
                                <button class="control-btn" id="previewSolutionBtn">üëÅÔ∏è Vorschau</button>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button class="btn-primary" id="saveTaskBtn">üíæ Aufgabe speichern</button>
                            <button class="btn-secondary" id="exportTasksBtn">üì§ Alle exportieren</button>
                            <button class="btn-secondary" id="importTasksBtn">üì• Importieren</button>
                            <input type="file" id="importFile" accept=".json" style="display: none;">
                        </div>
                    </div>

                    <div class="custom-tasks-list">
                        <h3>Gespeicherte Aufgaben</h3>
                        <div id="customTasksList"></div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Belohnungs-Popup -->
        <div class="reward-popup" id="rewardPopup">
            <div class="reward-content">
                <div class="reward-animation">üéâ</div>
                <h2>Fantastisch!</h2>
                <p class="reward-message" id="rewardMessage">Du hast die Aufgabe gel√∂st!</p>
                <div class="reward-rubox">
                    <span class="rubox-icon">üíé</span>
                    <span class="rubox-amount" id="rewardAmount">+10</span>
                </div>
                <button class="btn-primary" id="nextTaskBtn">Weiter zur n√§chsten Aufgabe</button>
            </div>
        </div>

        <!-- Level-Up-Popup -->
        <div class="levelup-popup" id="levelupPopup">
            <div class="levelup-content">
                <div class="levelup-animation">‚≠ê</div>
                <h2>Level Up!</h2>
                <p class="levelup-message" id="levelupMessage">Du hast Level 2 erreicht!</p>
                <button class="btn-primary" id="closeLevelupBtn">Super!</button>
            </div>
        </div>

        <!-- Share-Popup mit QR-Code -->
        <div class="share-popup" id="sharePopup">
            <div class="share-content">
                <button class="close-popup-btn" id="closeShareBtn">&times;</button>
                <h2>üì§ Seite teilen</h2>
                <p>Teile diese Seite mit deinen Sch√ºlern!</p>

                <div class="share-qr">
                    <canvas id="qrCanvas" width="200" height="200"></canvas>
                </div>

                <div class="share-link-area">
                    <label>Link zum Kopieren:</label>
                    <div class="link-copy-container">
                        <input type="text" id="shareLink" readonly>
                        <button class="copy-btn" id="copyLinkBtn">üìã Kopieren</button>
                    </div>
                    <span class="copy-feedback" id="copyFeedback"></span>
                </div>

                <div class="share-buttons">
                    <button class="share-option-btn" id="shareWhatsApp">
                        <span>üì±</span> WhatsApp
                    </button>
                    <button class="share-option-btn" id="shareEmail">
                        <span>‚úâÔ∏è</span> E-Mail
                    </button>
                    <button class="share-option-btn" id="downloadQR">
                        <span>üíæ</span> QR speichern
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- QR-Code Library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
