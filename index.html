<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xLogo Lernwelt - Spielerisch Programmieren lernen</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <div class="app-container">
        <!-- Header mit Rubox-Anzeige -->
        <header class="main-header">
            <div class="logo">
                <span class="turtle-icon">üê¢</span>
                <h1>xLogo Lernwelt</h1>
            </div>
            <div class="stats-bar">
                <div class="rubox-display">
                    <span class="rubox-icon">üíé</span>
                    <span class="rubox-count" id="ruboxCount">0</span>
                    <span class="rubox-label">Rubox</span>
                </div>
                <div class="level-display">
                    <span class="level-icon">‚≠ê</span>
                    <span class="level-text" id="playerLevel">Level 1</span>
                </div>
                <div class="streak-display">
                    <span class="streak-icon">üî•</span>
                    <span class="streak-count" id="streakCount">0</span>
                </div>
            </div>
            <nav class="main-nav">
                <button class="nav-btn active" data-view="learn">üìö <span data-i18n="nav.learn">Lernen</span></button>
                <button class="nav-btn" data-view="sandbox">üéÆ <span data-i18n="nav.sandbox">Sandbox</span></button>
                <button class="nav-btn" data-view="admin">‚öôÔ∏è <span data-i18n="nav.admin">Aufgaben</span></button>
                <button class="nav-btn share-btn" id="shareBtn">üì§ <span data-i18n="nav.share">Teilen</span></button>
            </nav>
            <div class="header-controls">
                <div class="language-selector">
                    <select id="languageSelect" title="Sprache / Language">
                        <option value="de">üá©üá™ Deutsch</option>
                        <option value="en">üá¨üáß English</option>
                    </select>
                </div>
                <button class="theme-toggle" id="themeToggle" title="Modus wechseln">
                    <span class="theme-icon">üåô</span>
                </button>
            </div>
        </header>

        <!-- Hauptinhalt -->
        <main class="main-content">
            <!-- Lern-Ansicht -->
            <section class="view learn-view active" id="learnView">
                <div class="difficulty-selector">
                    <div class="difficulty-cards">
                        <button class="difficulty-card beginner active" data-difficulty="beginner">
                            <span class="difficulty-emoji">üå±</span>
                            <span class="difficulty-name" data-i18n="difficulty.beginner">Anf√§nger</span>
                            <span class="difficulty-reward">+10</span>
                        </button>
                        <button class="difficulty-card intermediate" data-difficulty="intermediate">
                            <span class="difficulty-emoji">üåø</span>
                            <span class="difficulty-name" data-i18n="difficulty.intermediate">Fortgeschritten</span>
                            <span class="difficulty-reward">+25</span>
                        </button>
                        <button class="difficulty-card advanced" data-difficulty="advanced">
                            <span class="difficulty-emoji">üå≥</span>
                            <span class="difficulty-name" data-i18n="difficulty.advanced">Experte</span>
                            <span class="difficulty-reward">+50</span>
                        </button>
                    </div>
                </div>

                <div class="main-workspace">
                    <!-- Verstecktes Task-Panel f√ºr interne Nutzung -->
                    <div class="task-panel" style="display: none;">
                        <div class="task-header">
                            <h3 data-i18n="task.current">Aufgabe</h3>
                            <span class="task-number" id="taskNumber">1/5</span>
                        </div>
                        <div class="task-content" id="taskContent">
                            <p class="task-description" data-i18n="task.selectDifficulty">W√§hle einen Schwierigkeitsgrad!</p>
                        </div>
                        <button class="hint-btn" id="hintBtn" style="display: none;">üí° <span data-i18n="task.hint">Hinweis</span> (-5)</button>
                        <div class="hint-content" id="hintContent"></div>
                        <div class="expected-preview">
                            <h4 data-i18n="task.expected">Erwartet:</h4>
                            <canvas id="expectedCanvas" width="150" height="150"></canvas>
                        </div>
                    </div>

                    <!-- Links: Canvas -->
                    <div class="canvas-section">
                        <div class="canvas-container">
                            <canvas id="turtleCanvas" width="450" height="350"></canvas>
                        </div>
                        <div class="control-toolbar">
                            <div class="control-group">
                                <button class="control-btn run-btn" id="runBtn" title="F5">
                                    <span class="btn-icon">‚ñ∂Ô∏è</span>
                                </button>
                                <button class="control-btn stop-btn" id="stopBtn" title="Esc">
                                    <span class="btn-icon">‚èπÔ∏è</span>
                                </button>
                            </div>
                            <div class="control-group">
                                <button class="control-btn" id="stepBackBtn" title="‚Üê">
                                    <span class="btn-icon">‚èÆÔ∏è</span>
                                </button>
                                <button class="control-btn" id="stepForwardBtn" title="‚Üí">
                                    <span class="btn-icon">‚è≠Ô∏è</span>
                                </button>
                            </div>
                            <div class="control-group">
                                <button class="control-btn" id="resetBtn">
                                    <span class="btn-icon">üîÑ</span>
                                </button>
                                <button class="control-btn" id="clearBtn">
                                    <span class="btn-icon">üóëÔ∏è</span>
                                </button>
                            </div>
                            <div class="control-group speed-control">
                                <span>üê¢</span>
                                <input type="range" id="speedSlider" min="1" max="10" value="5">
                                <span>üêá</span>
                            </div>
                        </div>
                    </div>

                    <!-- Rechte Seite: Code + Konsole -->
                    <div class="code-section">
                        <div class="code-panel" id="codePanel">
                            <div class="code-header">
                                <h4 data-i18n="code.title">Code</h4>
                                <div class="code-hints">
                                    <span class="code-hint">fd()</span>
                                    <span class="code-hint">rt()</span>
                                    <span class="code-hint">repeat:</span>
                                    <span class="code-hint">‚åòL</span>
                                </div>
                            </div>
                            <div class="code-editor-container">
                                <div class="line-numbers" id="lineNumbers"></div>
                                <div class="code-display" id="codeDisplay">
                                    <div class="code-display-content" id="codeDisplayContent"></div>
                                </div>
                                <textarea id="codeInput" spellcheck="false" class="code-input-hidden" placeholder="# Code hier...
fd(100)
rt(90)

repeat 4:
    fd(100)
    rt(90)"></textarea>
                            </div>
                            <div class="fullscreen-hint">‚¨ÜÔ∏è ‚¨áÔ∏è Zeile wechseln  ‚Ä¢  ‚åòL oder Esc zum Beenden</div>
                        </div>
                        <div class="console-panel" id="consolePanel">
                            <div class="console-resize-handle" id="consoleResizeHandle"></div>
                            <div class="console-header">
                                <h4 data-i18n="console.title">Konsole</h4>
                                <div class="console-header-controls">
                                    <span class="console-shortcut">‚åòJ</span>
                                    <button class="console-toggle-btn" id="toggleConsoleBtn" title="Konsole ein-/ausblenden (‚åòJ)">‚àí</button>
                                    <button class="console-clear-btn" id="clearConsoleBtn">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="console-output" id="consoleOutput">
                                <div class="console-welcome" data-i18n="console.welcome">Dr√ºcke F5 zum Ausf√ºhren</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Sandbox-Ansicht -->
            <section class="view sandbox-view" id="sandboxView">
                <div class="sandbox-workspace">
                    <div class="sandbox-left">
                        <div class="command-reference">
                            <h4 data-i18n="reference.title">Befehle:</h4>
                            <div class="command-grid">
                                <code>fd(X)</code><code>bk(X)</code><code>rt(X)</code><code>lt(X)</code>
                                <code>pu()</code><code>pd()</code><code>repeat X:</code><code>print()</code>
                            </div>
                        </div>
                        <div class="canvas-container">
                            <canvas id="sandboxCanvas" width="500" height="400"></canvas>
                        </div>
                        <div class="control-toolbar">
                            <div class="control-group">
                                <button class="control-btn run-btn" id="sandboxRunBtn">‚ñ∂Ô∏è</button>
                                <button class="control-btn stop-btn" id="sandboxStopBtn">‚èπÔ∏è</button>
                            </div>
                            <div class="control-group">
                                <button class="control-btn" id="sandboxStepBackBtn">‚èÆÔ∏è</button>
                                <button class="control-btn" id="sandboxStepForwardBtn">‚è≠Ô∏è</button>
                            </div>
                            <div class="control-group">
                                <button class="control-btn" id="sandboxResetBtn">üîÑ</button>
                                <button class="control-btn" id="sandboxClearBtn">üóëÔ∏è</button>
                            </div>
                            <div class="control-group">
                                <input type="color" id="penColor" value="#00aa00">
                                <input type="range" id="penWidth" min="1" max="10" value="2" title="Breite">
                            </div>
                            <div class="control-group speed-control">
                                <span>üê¢</span>
                                <input type="range" id="sandboxSpeedSlider" min="1" max="10" value="5">
                                <span>üêá</span>
                            </div>
                        </div>
                    </div>
                    <div class="sandbox-right">
                        <div class="code-panel" id="sandboxCodePanel">
                            <div class="code-header">
                                <h4 data-i18n="code.title">Code</h4>
                                <div class="code-hints">
                                    <span class="code-hint">‚åòL Fullscreen</span>
                                </div>
                            </div>
                            <div class="code-editor-container sandbox-editor">
                                <div class="line-numbers" id="sandboxLineNumbers"></div>
                                <div class="code-display" id="sandboxCodeDisplay">
                                    <div class="code-display-content" id="sandboxCodeDisplayContent"></div>
                                </div>
                                <textarea id="sandboxCode" spellcheck="false" class="code-input-hidden" placeholder="# Freies Experimentieren!

repeat 4:
    fd(100)
    rt(90)

print('Fertig!')"></textarea>
                            </div>
                            <div class="fullscreen-hint">‚¨ÜÔ∏è ‚¨áÔ∏è Zeile wechseln  ‚Ä¢  ‚åòL oder Esc zum Beenden</div>
                        </div>
                        <div class="console-panel" id="sandboxConsolePanel">
                            <div class="console-resize-handle" id="sandboxConsoleResizeHandle"></div>
                            <div class="console-header">
                                <h4 data-i18n="console.title">Konsole</h4>
                                <div class="console-header-controls">
                                    <span class="console-shortcut">‚åòJ</span>
                                    <button class="console-toggle-btn" id="sandboxToggleConsoleBtn" title="Konsole ein-/ausblenden (‚åòJ)">‚àí</button>
                                    <button class="console-clear-btn" id="sandboxClearConsoleBtn">üóëÔ∏è</button>
                                </div>
                            </div>
                            <div class="console-output" id="sandboxConsoleOutput">
                                <div class="console-welcome" data-i18n="console.ready">Bereit!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Admin-Ansicht -->
            <section class="view admin-view" id="adminView">
                <div class="admin-container">
                    <h2 data-i18n="admin.title">Aufgaben erstellen</h2>
                    <div class="admin-grid">
                        <div class="admin-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="taskTitle" data-i18n="admin.taskTitle">Titel:</label>
                                    <input type="text" id="taskTitle" placeholder="z.B. Zeichne ein Dreieck">
                                </div>
                                <div class="form-group">
                                    <label for="taskDifficulty" data-i18n="admin.difficulty">Schwierigkeit:</label>
                                    <select id="taskDifficulty">
                                        <option value="beginner">üå± Anf√§nger</option>
                                        <option value="intermediate">üåø Fortgeschritten</option>
                                        <option value="advanced">üå≥ Experte</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="taskDescription" data-i18n="admin.description">Beschreibung:</label>
                                <textarea id="taskDescription" rows="2" placeholder="Beschreibe die Aufgabe..."></textarea>
                            </div>
                            <div class="form-group">
                                <label for="taskSolution" data-i18n="admin.solution">Musterl√∂sung:</label>
                                <textarea id="taskSolution" rows="4" placeholder="fd(100)
rt(90)"></textarea>
                            </div>
                            <div class="form-group">
                                <label for="taskHint" data-i18n="admin.hint">Hinweis:</label>
                                <input type="text" id="taskHint" placeholder="Ein hilfreicher Hinweis...">
                            </div>
                            <div class="form-actions">
                                <button class="btn-primary" id="saveTaskBtn">üíæ <span data-i18n="admin.save">Speichern</span></button>
                                <button class="btn-secondary" id="previewSolutionBtn">üëÅÔ∏è <span data-i18n="admin.preview">Vorschau</span></button>
                                <button class="btn-secondary" id="exportTasksBtn">üì§ Export</button>
                                <button class="btn-secondary" id="importTasksBtn">üì• Import</button>
                                <input type="file" id="importFile" accept=".json" style="display: none;">
                            </div>
                        </div>
                        <div class="admin-preview">
                            <canvas id="adminPreviewCanvas" width="250" height="250"></canvas>
                            <div class="custom-tasks-list">
                                <h4 data-i18n="admin.saved">Gespeichert:</h4>
                                <div id="customTasksList"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Belohnungs-Popup -->
        <div class="reward-popup" id="rewardPopup">
            <div class="reward-content">
                <div class="reward-animation">üéâ</div>
                <h2 data-i18n="reward.title">Fantastisch!</h2>
                <p class="reward-message" id="rewardMessage" data-i18n="reward.message">Aufgabe gel√∂st!</p>
                <div class="reward-rubox">
                    <span class="rubox-icon">üíé</span>
                    <span class="rubox-amount" id="rewardAmount">+10</span>
                </div>
                <button class="btn-primary" id="nextTaskBtn" data-i18n="reward.next">Weiter</button>
            </div>
        </div>

        <!-- Level-Up-Popup -->
        <div class="levelup-popup" id="levelupPopup">
            <div class="levelup-content">
                <div class="levelup-animation">‚≠ê</div>
                <h2>Level Up!</h2>
                <p class="levelup-message" id="levelupMessage"></p>
                <button class="btn-primary" id="closeLevelupBtn">Super!</button>
            </div>
        </div>

        <!-- Share-Popup -->
        <div class="share-popup" id="sharePopup">
            <div class="share-content">
                <button class="close-popup-btn" id="closeShareBtn">&times;</button>
                <h2>üì§ <span data-i18n="share.title">Teilen</span></h2>
                <div class="share-qr">
                    <canvas id="qrCanvas" width="180" height="180"></canvas>
                </div>
                <div class="share-link-area">
                    <div class="link-copy-container">
                        <input type="text" id="shareLink" readonly>
                        <button class="copy-btn" id="copyLinkBtn">üìã</button>
                    </div>
                    <span class="copy-feedback" id="copyFeedback"></span>
                </div>
                <div class="share-buttons">
                    <button class="share-option-btn" id="shareWhatsApp">üì± WhatsApp</button>
                    <button class="share-option-btn" id="shareEmail">‚úâÔ∏è E-Mail</button>
                    <button class="share-option-btn" id="downloadQR">üíæ QR</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
